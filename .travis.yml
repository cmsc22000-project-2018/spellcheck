language: c

git:
  submodules: false

before_install:
    - sudo add-apt-repository -y ppa:snaipewastaken/ppa
    - sudo apt-get update -q
    - sudo apt-get install criterion-dev -y
    - git clone https://github.com/redis/hiredis.git
    - cd hiredis
    - make
    - sudo make install
    - sudo ldconfig
    - cd ..
    - sed -i 's/git@github.com:/https:\/\/github.com\//' .gitmodules
    - git submodule update --init --recursive

services: 
    - redis-server

script:
    - make tests
    - ./tests/test-spellcheck
    - make
    - ./spellcheck tests/test_short.txt -v -l -l -l
    - ./spellcheck tests/test_short.txt -q -s test_save.txt
    - ./spellcheck < tests/test_main0.txt
    - ./spellcheck < tests/test_main1.txt
    - ./spellcheck < tests/test_main2.txt
    - make clean
